---
version: "{build}"

clone_depth: 10

install:
  - SET PATH=C:\Ruby%ruby_version%\DevKit\bin;C:\Ruby%ruby_version%\DevKit\mingw\bin;C:\Ruby%ruby_version%\bin;%PATH%
  - ruby --version
  - gem --version
  - gem install bundler --quiet --no-ri --no-rdoc
  - bundler --version
  - bundle install
  - choco install pkgconfiglite

build_script:
  - rake native gem

on_failure:
  - type 'ext\rugged\mkmf.log'

test_script:
  - rake test

artifacts:
  - path: '**\mkmf.log'
  - path: pkg\*.gem

matrix:
  fast_finish: true

environment:
  matrix:
    - ruby_version: "193"
    - ruby_version: "200"
    - ruby_version: "200-x64"
    - ruby_version: "21"
    - ruby_version: "21-x64"